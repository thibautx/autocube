{% extends "page.html" %}
{% block title %} Car Details {% endblock %}
{% block head %}
{{ super() }}
{% endblock %}
{% block content %}
<div class="panel panel-default">
    <div class="panel-heading">
        <div class="jumbotron" style="background: #ffffff; !important">
            <div class="row">
                <div class="col-md-2">
                    <a href="{{ url_for('.garage_home') }}" class="btn btn-default btn-sm" role="button">
                        <span class="glyphicon glyphicon-arrow-left"></span> Back to my cars
                    </a>
                </div>
                <div class="col-md-2 col-md-offset-8">
                    <form action="{{ url_for('.remove_car', id=car.id) }}" method=post>
                        <button class="btn btn-default btn-sm">
                            <input type=hidden value="{{ car.id }}" name=car_id>
                                <span class="glyphicon glyphicon-trash"></span> Remove car
                            </input>
                        </button>
                    </form>
                </div>
            </div>
            <br>
            <br>
            <div class="row">
                <div class="col-md-4">
                    <img src="../../static/images/lambo.jpeg" height="100px" width="200px">
                </div>
                <div class="col-md-4">
                   <h4>{{ car.year }} </h4>
                    <h2>{{ car.make }} {{ car.model }}</h2>
                    Recommended services: <br>
                    Total Mileage: <br>
                    Daily Mileage Average: <br>
                </div>
                <div class="col-md-4">
                    baz
                </div>
            </div>
        </div>
    </div>
    <div class="panel-body">
        <ul class="nav nav-tabs" id="myTab">
            <li class="active"><a href="#tab-1" role="tab" data-toggle="tab">Car Details</a></li>
            <li>
                <a href="#tab-2" role="tab" data-toggle="tab">Recalls <span class="label label-danger">{{ recalls|length }}</span></a>
            </li>
            <li><a href="#tab-3" role="tab" data-toggle="tab">Service Bulletins <span class="label label-warning">{{ service_bulletins|length }}</span></a></li>
        </ul>
        <div class="tab-content">
            <br>
            <br>

            <!-- Car Details-->
            <div class="tab-pane active" role="tabpanel" id="tab-1">
                <form class="form-horizontal" action="{{ url_for('.update_car', id=car.id) }}" method="post">
                    <fieldset>
                    <!-- Current Mileage -->
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="current_mileage">Current Mileage</label>
                      <div class="col-md-4">
                      <input id="current_mileage" name="current_mileage" type="text"
                             {% if car.current_mileage is not none %}
                             value="{{ car.current_mileage }}"
                             {% endif %}
                             placeholder="Current mileage on this car"
                             class="form-control input-md">
                      </div>
                    </div>

                    <!-- VIN -->
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="vin">VIN</label>
                      <div class="col-md-4">
                      <input id="vin" name="vin" type="text"
                             {% if car.vin is not none %}
                             value="{{ car.vin }}"
                             {% endif %}
                             placeholder="Vin on this car"
                             class="form-control input-md">
                      </div>
                    </div>

                    <!-- Transmission Type -->
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="transmission_type">What is your transmission type?</label>
                      <div class="col-md-4">
                        <select id="transmission_type" name="transmission_type" class="form-control">
                          <option value="automatic">Automatic</option>
                          <option value="manual">Manual</option>
                        </select>
                      </div>
                    </div>

                    <!-- Oil Type-->
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="oil_type">What type of engine oil do you use?</label>
                      <div class="col-md-4">
                        <select id="oil_type" name="oil_type" class="form-control">
                          <option value="1">Regular</option>
                          <option value="2">Synthetic</option>
                          <option value="3">I don't know</option>
                        </select>
                      </div>
                    </div>

                    <!-- Button -->
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="car-details-save"></label>
                      <div class="col-md-4">
                        <button id="car-details-save" class="btn btn-default" type="submit">Save</button>
                      </div>
                    </div>
                        </fieldset>
                    </form>
            </div>

            <!-- Recalls -->
            <div class="tab-pane" role="tabpanel" id="tab-2">
                {% for recall in recalls %}
                <div class="panel panel-danger">
                    <div class="panel-heading">NHTSA Campaign: {{ recall.nhtsa_number }}</div>
                    <div class="panel-body">
                        <h4>Recall consequence:</h4>
                        {{ recall.consequence }} <br> <br>
                        <h4>Affected Components:</h4>
                        {{ recall.components}} <br><br>
                    </div>
                    <div class="panel-footer">
                      <button type="submit" class="btn btn-default" data-toggle="modal" data-target="#serviceCarModal">
                          FIX SAFETY RECALL NOW
                      </button>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Service Bulletins -->
            <div class="tab-pane" role="tabpanel" id="tab-3">
                {% for bulletin in service_bulletins %}
                <div class="panel panel-danger">
                    <div class="panel-heading">NHTSA Campaign: {{ bulletin.nhtsa_number }}</div>
                    <div class="panel-body">
                        <h4>Summary:</h4>
                        {{ bulletin.summary }} <br> <br>
                        <h4>Affected Components:</h4>
                        {{ bulletin.component_description}} <br><br>
                    </div>
                    <div class="panel-footer">
                      <button type="button" class="btn btn-default">
                          SERVICE NOW
                      </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Service Car Modal -->
<div class="modal fade" id="serviceCarModal" role="dialog">
<div class="modal-dialog">

    <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">&times;</button>
      <h4 class="modal-title" align="center">Find a dealer:</h4>
    </div>

    <div class="modal-body container-fluid">
        <form name="find-dealer" action="{{ url_for('.service_car', id=car.id) }}" method=post>
            <div class="form-group">
              <label class="col-md-4 control-label" for="zip">Zip Code</label>
              <input id="zip" name="zip" type="text" {% if current_user.zip_code is defined %} value="{{ current_user.zip_code }}"{% endif %}placeholder="Your zip code" class="form-control input-md">
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-default tn-md">Find dealers</button>
            </div>
        </form>
    </div>
  </div>
</div>
</div>
{% endblock %}
{% block scripts %}
    <script src="{{ url_for('static', filename='js/car-details-tabs.js') }}" type="text/javascript"></script>
{% endblock %}
